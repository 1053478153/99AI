
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as G}from"./index.vue_vue_type_script_setup_true_lang-CHWp65cL.js";import{A as U}from"./chat-BAyuGdeQ.js";import{A as K}from"./mj-akyFMlB2.js";import{u as Q}from"./utcformatTime-Bq4gDWNx.js";import{b as X,W as Z}from"./index-DfBvkKrB.js";import{d as ee,r as h,m as te,a as le,n as o,q as ae,g as _,c as C,b as t,w as l,F as V,s as $,i as p,h as d,e as b,y as oe,z as I,t as m,E as L,k as N}from"./index-CAe0BuuW.js";const ne={style:{float:"right"}},re={class:"answer"},se={class:"answer_container"},ie=["src"],ce=ee({__name:"draw",setup(ue){const k=h(),z=h(0),w=h(!1),s=te({rec:null,status:null,page:1,size:10}),D=h([]);async function c(){try{w.value=!0;const n=await K.queryAdminDrawList(s);w.value=!1;const{rows:a,count:g}=n.data;z.value=g,D.value=a}catch{w.value=!1}}function P(n){n==null||n.resetFields(),c()}async function R(n){const a=await U.recMjDrawImg({id:n});L.success(a.data),c()}async function j(n){const a=await U.delChatLog({id:n});L.success(a.data),c()}return le(()=>{c()}),(n,a)=>{const g=o("el-option"),x=o("el-select"),v=o("el-form-item"),f=o("el-button"),B=o("el-form"),y=G,Y=o("el-alert"),r=o("el-table-column"),q=o("el-image"),F=o("el-tag"),O=o("el-popover"),A=o("el-popconfirm"),W=o("el-table"),E=o("el-pagination"),H=o("el-row"),J=ae("loading");return _(),C("div",null,[t(y,null,{default:l(()=>[t(B,{ref_key:"formRef",ref:k,inline:!0,model:s},{default:l(()=>[t(v,{label:"推荐状态",prop:"rec"},{default:l(()=>[t(x,{modelValue:s.rec,"onUpdate:modelValue":a[0]||(a[0]=e=>s.rec=e),placeholder:"请选择推荐状态",clearable:"",style:{width:"160px"}},{default:l(()=>[(_(!0),C(V,null,$(p(X),e=>(_(),I(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"绘制状态",prop:"status"},{default:l(()=>[t(x,{modelValue:s.status,"onUpdate:modelValue":a[1]||(a[1]=e=>s.status=e),placeholder:"请选择绘制状态",clearable:"",style:{width:"160px"}},{default:l(()=>[(_(!0),C(V,null,$(p(Z),e=>(_(),I(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:l(()=>[t(f,{type:"primary",onClick:c},{default:l(()=>[d(" 查询 ")]),_:1}),t(f,{onClick:a[2]||(a[2]=e=>P(p(k)))},{default:l(()=>[d(" 重置 ")]),_:1})]),_:1}),b("span",ne,[t(f,{type:"success",onClick:c},{default:l(()=>[d(" 刷新列表 ")]),_:1})])]),_:1},8,["model"])]),_:1}),t(y,null,{default:l(()=>[t(Y,{"show-icon":"",title:"MJ绘图历史说明",description:"点击推荐的图片将会出现在画廊当中！",type:"success"})]),_:1}),t(y,{style:{width:"100%"}},{default:l(()=>[oe((_(),I(W,{border:"",data:p(D),style:{width:"100%"},size:"large"},{default:l(()=>[t(r,{prop:"id",align:"center",label:"ID",width:"70"}),t(r,{prop:"drawUrl",align:"center",label:"绘图结果"},{default:l(e=>{var i,u;return[t(q,{style:{height:"120px"},"preview-teleported":"",fit:"contain","preview-src-list":[(i=e.row)==null?void 0:i.drawUrl],src:(u=e.row)==null?void 0:u.drawUrl,lazy:"","hide-on-click-modal":""},null,8,["preview-src-list","src"])]}),_:1}),t(r,{prop:"userInfo.username",align:"center",label:"用户名",width:"120"}),t(r,{prop:"fileInfo.thumbImg",align:"center",label:"推荐状态",width:"90"},{default:l(e=>[t(F,{type:e.row.rec===1?"success":"info"},{default:l(()=>[d(m(e.row.rec===1?"已推荐":"未推荐"),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"userInfo.email",label:"邮箱",width:"180",align:"center"}),t(r,{prop:"fullPrompt",label:"绘图指令",align:"center",width:"200"},{default:l(e=>[t(O,{placement:"top",width:400,trigger:"click"},{reference:l(()=>[b("div",re,m(e.row.fullPrompt),1)]),default:l(()=>[b("div",se,m(e.row.fullPrompt),1)]),_:2},1024)]),_:1}),t(r,{prop:"progress",align:"center",label:"绘图进度",width:"90"}),t(r,{prop:"fileInfo.thumbImg",align:"center",label:"绘图尺寸",width:"120"},{default:l(e=>{var i,u,M,S,T;return[d(m((i=e.row)!=null&&i.fileInfo?`${(M=(u=e.row)==null?void 0:u.fileInfo)==null?void 0:M.width}*${(T=(S=e.row)==null?void 0:S.fileInfo)==null?void 0:T.height}`:"---"),1)]}),_:1}),t(r,{prop:"userInfo.avatar",label:"用户头像",width:"90"},{default:l(e=>{var i,u;return[b("img",{src:(u=(i=e.row)==null?void 0:i.userInfo)==null?void 0:u.avatar,style:{height:"50px"}},null,8,ie)]}),_:1}),t(r,{prop:"createdAt",label:"提问时间",align:"center",width:"200"},{default:l(e=>[d(m(p(Q)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),t(r,{fixed:"right",label:"操作",width:"200",align:"center"},{default:l(e=>[t(A,{title:`确认${e.row.rec===1?"取消推荐":"推荐"}图片吗！`,width:"260","icon-color":"red",onConfirm:i=>R(e.row.id)},{reference:l(()=>[t(f,{link:"",type:e.row.rec===1?"success":"",size:"small"},{default:l(()=>[d(" 推荐图片 ")]),_:2},1032,["type"])]),_:2},1032,["title","onConfirm"]),t(A,{title:"`确认删除此条记录么！",width:"260","icon-color":"red",onConfirm:i=>j(e.row.id)},{reference:l(()=>[t(f,{type:"warning",size:"small"},{default:l(()=>[d(" 删除记录 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[J,p(w)]]),t(H,{class:"mt-5 flex justify-end"},{default:l(()=>[t(E,{"current-page":s.page,"onUpdate:currentPage":a[3]||(a[3]=e=>s.page=e),"page-size":s.size,"onUpdate:pageSize":a[4]||(a[4]=e=>s.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:p(z),onSizeChange:c,onCurrentChange:c},null,8,["current-page","page-size","total"])]),_:1})]),_:1})])}}});typeof N=="function"&&N(ce);export{ce as default};
