
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as S}from"./index.vue_vue_type_script_setup_true_lang-CiyjFa2H.js";import{d as K,m as P,r as f,a as w,n as s,g as H,c as q,b as e,w as a,h as A,e as i,E as _,j as k,_ as N,k as h}from"./index-DEc4xym2.js";import{a as C}from"./config-BQ9gBCXa.js";const M=i("div",{class:"flex items-center gap-4"},"微信支付设置",-1),B=i("div",{class:"text-sm/6"},[i("div",null," 同时开启多个支付，将以微信支付作为最高优先级，在pc端会调用 native 支付，在微信环境内将调用 Jsapi 支付。 "),i("div",null," 请确认微信支付已经申请了支付权限，支付通知地址为： https://您的域名/api/pay/notify。 ")],-1),j=K({__name:"wechat",setup(E){const t=P({payWechatStatus:"",payWeChatMchId:"",payWeChatAppId:"",payWeChatSecret:"",payWeChatNotifyUrl:"",payWeChatH5Url:"",payWeChatPublicKey:"",payWeChatPrivateKey:""}),g=f({payWechatStatus:[{required:!0,trigger:"change",message:"请选择当前支付开启状态"}],payWeChatSecret:[{required:!0,trigger:"blur",message:"请填写支付Secret秘钥"}],payWeChatMchId:[{required:!0,trigger:"blur",message:"请填写商户号"}],payWeChatAppId:[{required:!0,trigger:"blur",message:"请填写AppId"}],payWeChatNotifyUrl:[{required:!0,trigger:"blur",message:"请填写支付通知地址"}],payWeChatH5Url:[{required:!0,trigger:"blur",message:"请填写H5支付通知地址"}],payWeChatPublicKey:[{required:!0,trigger:"blur",message:"请填写支付公钥信息（cert.pem文件）"}],payWeChatPrivateKey:[{required:!0,trigger:"blur",message:"请填写支付私钥地址（key.pem文件）"}]}),m=f();async function c(){const o=await C.queryConfig({keys:["payWeChatSecret","payWeChatNotifyUrl","payWeChatH5Url","payWeChatAppId","payWechatStatus","payWeChatMchId","payWeChatPublicKey","payWeChatPrivateKey"]});Object.assign(t,o.data)}function W(){var o;(o=m.value)==null||o.validate(async l=>{if(l){try{await C.setConfig({settings:b(t)}),_.success("变更配置信息成功")}catch{}c()}else _.error("请填写完整信息")})}function b(o){return Object.keys(o).map(l=>({configKey:l,configVal:o[l]}))}return w(()=>{c()}),(o,l)=>{const y=k,V=N,x=S,v=s("el-switch"),p=s("el-form-item"),u=s("el-col"),d=s("el-row"),n=s("el-input"),U=s("el-form"),I=s("el-card");return H(),q("div",null,[e(x,null,{title:a(()=>[M]),content:a(()=>[B]),default:a(()=>[e(V,{outline:"",onClick:W},{default:a(()=>[e(y,{name:"i-ri:file-text-line"}),A(" 保存设置 ")]),_:1})]),_:1}),e(I,{style:{margin:"20px"}},{default:a(()=>[e(U,{ref_key:"formRef",ref:m,rules:g.value,model:t,"label-width":"140px"},{default:a(()=>[e(d,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"启用当前支付",prop:"payWechatStatus"},{default:a(()=>[e(v,{modelValue:t.payWechatStatus,"onUpdate:modelValue":l[0]||(l[0]=r=>t.payWechatStatus=r),"active-value":"1","inactive-value":"0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"商户ID",prop:"payWeChatMchId"},{default:a(()=>[e(n,{modelValue:t.payWeChatMchId,"onUpdate:modelValue":l[1]||(l[1]=r=>t.payWeChatMchId=r),placeholder:"请填写商户ID",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"AppId",prop:"payWeChatAppId"},{default:a(()=>[e(n,{modelValue:t.payWeChatAppId,"onUpdate:modelValue":l[2]||(l[2]=r=>t.payWeChatAppId=r),placeholder:"请填写AppId",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"商户秘钥",prop:"payWeChatSecret"},{default:a(()=>[e(n,{modelValue:t.payWeChatSecret,"onUpdate:modelValue":l[3]||(l[3]=r=>t.payWeChatSecret=r),placeholder:"请填写Secret秘钥",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"支付通知地址",prop:"payWeChatNotifyUrl"},{default:a(()=>[e(n,{modelValue:t.payWeChatNotifyUrl,"onUpdate:modelValue":l[4]||(l[4]=r=>t.payWeChatNotifyUrl=r),placeholder:"请填写支付通知地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"H5支付通知地址",prop:"payWeChatH5Url"},{default:a(()=>[e(n,{modelValue:t.payWeChatH5Url,"onUpdate:modelValue":l[5]||(l[5]=r=>t.payWeChatH5Url=r),placeholder:"请填写H5支付通知地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"公钥地址",prop:"payWeChatPublicKey"},{default:a(()=>[e(n,{modelValue:t.payWeChatPublicKey,"onUpdate:modelValue":l[6]||(l[6]=r=>t.payWeChatPublicKey=r),type:"textarea",rows:6,placeholder:"请填写支付公钥信息（cert.pem文件）",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(d,null,{default:a(()=>[e(u,{xs:24,md:20,lg:15,xl:12},{default:a(()=>[e(p,{label:"私钥地址",prop:"payWeChatPrivateKey"},{default:a(()=>[e(n,{modelValue:t.payWeChatPrivateKey,"onUpdate:modelValue":l[7]||(l[7]=r=>t.payWeChatPrivateKey=r),type:"textarea",rows:6,placeholder:"请填写支付私钥地址（key.pem文件）",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1})])}}});typeof h=="function"&&h(j);export{j as default};
