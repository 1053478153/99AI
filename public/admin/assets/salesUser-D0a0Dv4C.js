
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as H}from"./index.vue_vue_type_script_setup_true_lang-CHWp65cL.js";import{_ as T}from"./index.vue_vue_type_script_setup_true_lang-D6-4wUAO.js";import{A as x}from"./sales-DHN85h7l.js";import{d as G,r as c,m as V,a as J,n as u,q as K,g as I,c as Q,b as e,w as a,h as n,i as _,y as W,z as X,e as S,t as g,D as Y,E as Z,k as A}from"./index-CAe0BuuW.js";const E=S("div",{class:"flex items-center gap-4"},"佣金账户列表",-1),ee=["src"],te=G({__name:"salesUser",setup(ae){const C=c(),N=c(0),v=c(!1),d=c(!1),U=c(),i=V({performanceRatio:0,salesOutletName:"",userId:0}),r=V({salesOutletName:"",performanceRatio:null,page:1,size:10}),B=V({performanceRatio:[{required:!0,message:"请填写佣金比例",trigger:"blur"}],salesOutletName:[{required:!0,message:"请填写自定义分销名称",trigger:"blur"}]}),k=c([]);async function p(){try{v.value=!0;const o=await x.querySalesUserList(r);v.value=!1;const{rows:l,count:w}=o.data;N.value=w,k.value=l}catch{v.value=!1}}function M(o){o==null||o.resetFields(),p()}async function $(o){o==null||o.validate(async l=>{l&&(await x.updateSalesUser(i),Z.success("修改信息成功！"),d.value=!1,p())})}async function q(o){const{userId:l,performanceRatio:w,salesOutletName:m}=o;i.performanceRatio=w,i.salesOutletName=m,d.value=!0,i.userId=l}return J(()=>{p()}),(o,l)=>{const w=T,m=u("el-input"),y=u("el-form-item"),b=u("el-button"),h=u("el-form"),z=H,s=u("el-table-column"),f=u("el-tag"),D=u("el-table"),j=u("el-pagination"),L=u("el-row"),P=u("el-dialog"),F=K("loading");return I(),Q("div",null,[e(w,null,{title:a(()=>[E]),_:1}),e(z,null,{default:a(()=>[e(h,{ref_key:"formRef",ref:C,inline:!0,model:r},{default:a(()=>[e(y,{label:"分销人代号",prop:"salesOutletName"},{default:a(()=>[e(m,{modelValue:r.salesOutletName,"onUpdate:modelValue":l[0]||(l[0]=t=>r.salesOutletName=t),placeholder:"填写分销人代号搜索"},null,8,["modelValue"])]),_:1}),e(y,{label:"返佣比例",prop:"performanceRatio"},{default:a(()=>[e(m,{modelValue:r.performanceRatio,"onUpdate:modelValue":l[1]||(l[1]=t=>r.performanceRatio=t),placeholder:"填写分销人返佣比例"},null,8,["modelValue"])]),_:1}),e(y,null,{default:a(()=>[e(b,{type:"primary",onClick:p},{default:a(()=>[n(" 查询 ")]),_:1}),e(b,{onClick:l[2]||(l[2]=t=>M(_(C)))},{default:a(()=>[n(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(z,{style:{width:"100%"}},{default:a(()=>[W((I(),X(D,{border:"",data:_(k),style:{width:"100%"},size:"large"},{default:a(()=>[e(s,{prop:"userInfo.avatar",label:"头像",width:"120"},{default:a(t=>{var R,O;return[S("img",{src:(O=(R=t.row)==null?void 0:R.userInfo)==null?void 0:O.avatar,style:{height:"50px"}},null,8,ee)]}),_:1}),e(s,{prop:"userInfo.email",label:"邮箱",width:"200"}),e(s,{prop:"salesOutletName",label:"分销人代号",width:"120"}),e(s,{prop:"performanceRatio",label:"分销人佣金比例",align:"center"},{default:a(t=>[e(f,null,{default:a(()=>[n(g(t.row.performanceRatio)+"% ",1)]),_:2},1024)]),_:1}),e(s,{prop:"orderCount",label:"累计分销订单量",align:"center"},{default:a(t=>[e(f,{type:"success"},{default:a(()=>[n(g(t.row.orderCount),1)]),_:2},1024)]),_:1}),e(s,{prop:"totalAmount",label:"分销人账户总金额",align:"center",width:"150"},{default:a(t=>[e(f,{type:t.row.totalAmount>0?"success":"danger"},{default:a(()=>[n(" ￥"+g(t.row.totalAmount),1)]),_:2},1032,["type"])]),_:1}),e(s,{prop:"withdrawalAmount",label:"分销人已提现金额",align:"center",width:"150"},{default:a(t=>[e(f,{type:t.row.withdrawalAmount>0?"success":"danger"},{default:a(()=>[n(" ￥"+g(t.row.withdrawalAmount),1)]),_:2},1032,["type"])]),_:1}),e(s,{prop:"distributionBalance",label:"分销人可提现金额",align:"center",width:"150"},{default:a(t=>[e(f,{type:t.row.distributionBalance>0?"success":"danger"},{default:a(()=>[n(" ￥"+g(t.row.distributionBalance),1)]),_:2},1032,["type"])]),_:1}),e(s,{prop:"drawMoneyIn",label:"分销人正在提现金额",align:"center"},{default:a(t=>[e(f,{type:t.row.drawMoneyIn>0?"success":"danger"},{default:a(()=>[n(" ￥"+g(t.row.drawMoneyIn),1)]),_:2},1032,["type"])]),_:1}),e(s,{fixed:"right",label:"操作",width:"100",align:"center"},{default:a(t=>[e(b,{link:"",type:"primary",size:"small",onClick:R=>q(t.row)},{default:a(()=>[n(" 变更用户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[F,_(v)]]),e(L,{class:"flex justify-end mt-5"},{default:a(()=>[e(j,{"current-page":r.page,"onUpdate:currentPage":l[3]||(l[3]=t=>r.page=t),"page-size":r.size,"onUpdate:pageSize":l[4]||(l[4]=t=>r.size=t),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:_(N),onSizeChange:p,onCurrentChange:p},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),e(P,{modelValue:_(d),"onUpdate:modelValue":l[9]||(l[9]=t=>Y(d)?d.value=t:null),title:"修改用户权限",width:"450px"},{footer:a(()=>[e(b,{onClick:l[7]||(l[7]=t=>d.value=!1)},{default:a(()=>[n(" 我再想想 ")]),_:1}),e(b,{type:"primary",onClick:l[8]||(l[8]=t=>$(_(U)))},{default:a(()=>[n(" 确认修改 ")]),_:1})]),default:a(()=>[e(h,{ref_key:"cramiRef",ref:U,model:i,rules:B,"label-width":"105px"},{default:a(()=>[e(y,{label:"佣金比例",prop:"performanceRatio"},{default:a(()=>[e(m,{modelValue:i.performanceRatio,"onUpdate:modelValue":l[5]||(l[5]=t=>i.performanceRatio=t),modelModifiers:{number:!0},type:"number",placeholder:"设置佣金比例"},null,8,["modelValue"])]),_:1}),e(y,{label:"自定义名称",prop:"salesOutletName"},{default:a(()=>[e(m,{modelValue:i.salesOutletName,"onUpdate:modelValue":l[6]||(l[6]=t=>i.salesOutletName=t),placeholder:"设置自定义名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});typeof A=="function"&&A(te);export{te as default};
