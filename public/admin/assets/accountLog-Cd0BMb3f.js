
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.github.io
 */

import{_ as F}from"./index.vue_vue_type_script_setup_true_lang-DKdjIYRj.js";import{_ as H}from"./index.vue_vue_type_script_setup_true_lang-CiyjFa2H.js";import{I as M,d as G,r as _,m as P,a as O,n as r,q as K,g as u,c as h,b as a,w as t,F as R,s as V,i as m,h as d,y as J,z as C,t as b,e as Q,K as W,k as q}from"./index-DEc4xym2.js";import{o as X,p as Z,U as ee,m as ae}from"./index-J5zVJPyL.js";import{u as te}from"./utcformatTime-Bq4gDWNx.js";const le={upgradeBalance:g=>M.post("balance/upgradeBalance",g),queryUserAccountLog:g=>M.get("balance/accountLog",{params:g})},oe=Q("div",{class:"flex items-center gap-4"},"账户明细",-1),re=G({__name:"accountLog",setup(g){const T=_(),A=_(0),f=_(!1),n=P({userId:"",rechargeType:"",packageId:"",page:1,size:15});P({model3Count:[{required:!0,message:"请填写赠送基础模型额度",trigger:"blur"}],model4Count:[{required:!0,message:"请填写赠送高级模型额度",trigger:"blur"}],drawMjCount:[{required:!0,message:"请填写赠送绘画积分额度",trigger:"blur"}]});const U=_(),k=_([]);async function i(){try{f.value=!0;const s=await le.queryUserAccountLog(n),{rows:l,count:w}=s.data;f.value=!1,A.value=w,k.value=l}catch{f.value=!1}}async function D(s){const l=await W.queryAllUser({size:30,keyword:s});U.value=l.data.rows}function B(s){s==null||s.resetFields(),i()}return O(()=>i()),(s,l)=>{const w=H,x=r("el-option"),z=r("el-select"),y=r("el-form-item"),I=r("el-button"),L=r("el-form"),S=F,Y=r("el-avatar"),o=r("el-table-column"),v=r("el-tag"),E=r("el-table"),j=r("el-pagination"),N=r("el-row"),$=K("loading");return u(),h("div",null,[a(w,null,{title:t(()=>[oe]),_:1}),a(S,null,{default:t(()=>[a(L,{ref_key:"formRef",ref:T,inline:!0,model:n},{default:t(()=>[a(y,{label:"用户名称",prop:"userId"},{default:t(()=>[a(z,{modelValue:n.userId,"onUpdate:modelValue":l[0]||(l[0]=e=>n.userId=e),filterable:"",clearable:"",remote:"","reserve-keyword":"",placeholder:"昵称|手机号|邮箱[模糊搜索]","remote-show-suffix":"","remote-method":D,style:{width:"200px"}},{default:t(()=>[(u(!0),h(R,null,V(U.value,e=>(u(),C(x,{key:e.id,label:e.username,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(y,{label:"充值类型",prop:"rechargeType"},{default:t(()=>[a(z,{modelValue:n.rechargeType,"onUpdate:modelValue":l[1]||(l[1]=e=>n.rechargeType=e),placeholder:"请选择充值类型",clearable:"",style:{width:"160px"}},{default:t(()=>[(u(!0),h(R,null,V(m(X),e=>(u(),C(x,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(y,null,{default:t(()=>[a(I,{type:"primary",onClick:i},{default:t(()=>[d(" 查询 ")]),_:1}),a(I,{onClick:l[2]||(l[2]=e=>B(T.value))},{default:t(()=>[d(" 重置 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(S,{style:{width:"100%"}},{default:t(()=>[J((u(),C(E,{border:"",data:k.value,style:{width:"100%"},size:"large"},{default:t(()=>[a(o,{prop:"avatar",label:"用户头像",width:"120",fixed:""},{default:t(e=>[a(Y,{src:e.row.avatar},null,8,["src"])]),_:1}),a(o,{prop:"username",label:"用户名称",width:"150",fixed:""}),a(o,{prop:"userId",label:"用户ID",width:"80"}),a(o,{prop:"uid",label:"订单ID",width:"130"}),a(o,{prop:"email",label:"用户邮箱",width:"250",align:"left"}),a(o,{prop:"balanceInfo.useModel4Count",label:"充值类型",width:"160",align:"center"},{default:t(e=>[a(v,{type:"success"},{default:t(()=>{var c,p;return[d(b((c=e.row)!=null&&c.rechargeType?m(Z)[(p=e.row)==null?void 0:p.rechargeType]:"---"),1)]}),_:2},1024)]),_:1}),a(o,{prop:"model3Count",label:"基础模型额度",width:"120",align:"center"}),a(o,{prop:"model4Count",label:"高级模型额度",width:"120",align:"center"}),a(o,{prop:"drawMjCount",label:"绘画余额额度",width:"120",align:"center"}),a(o,{label:"额度有效期",width:"170",align:"center"},{default:t(e=>[a(v,{type:"success"},{default:t(()=>{var c,p;return[d(b(((c=e.row)==null?void 0:c.days)<=0?"永久时效":`${(p=e.row)==null?void 0:p.days}天`),1)]}),_:2},1024)]),_:1}),a(o,{prop:"status",label:"用户状态",width:"120",align:"center"},{default:t(({row:e})=>[a(v,{type:m(ee)[e.status]},{default:t(()=>[d(b(m(ae)[e.status]),1)]),_:2},1032,["type"])]),_:1}),a(o,{prop:"createdAt",label:"充值时间",width:"200",align:"center"},{default:t(e=>[d(b(m(te)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1})]),_:1},8,["data"])),[[$,f.value]]),a(N,{class:"mt-5 flex justify-end"},{default:t(()=>[a(j,{"current-page":n.page,"onUpdate:currentPage":l[3]||(l[3]=e=>n.page=e),"page-size":n.size,"onUpdate:pageSize":l[4]||(l[4]=e=>n.size=e),class:"mr-5","page-sizes":[15,30,50,100],layout:"total, sizes, prev, pager, next, jumper",total:A.value,onSizeChange:i,onCurrentChange:i},null,8,["current-page","page-size","total"])]),_:1})]),_:1})])}}});typeof q=="function"&&q(re);export{re as default};
